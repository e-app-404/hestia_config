
# Merge this into /config/hestia/config/system/hestia.toml

[automation.lineage_guardian]
enabled = true
schedule_cron = "0 3 * * *"
verbose_logging = true
log_location = "/config/hestia/reports/{date}/lineage__{timestamp}__validation.log"

[automation.lineage_guardian.scanner]
template_directory = "/config/domain/templates/"
recursive = true
file_patterns = ["*.yaml", "*.yml"]
exclude_patterns = ["*_test.yaml", "*_backup.yaml"]
parse_macros = true
macro_files = ["template.library.jinja"]

[automation.lineage_guardian.validator]
enforce_bidirectional = true
allow_self_references = false
require_source_count = true
valid_domains = [
"binary_sensor","sensor","light","switch",
"automation","script","person","input_boolean","device_tracker"
]

[automation.lineage_guardian.corrector]
backup_before_modify = true
backup_suffix = ".lineage_backup"
atomic_writes = true
preserve_formatting = true
update_timestamp_field = "last_updated"
timestamp_format = "%Y-%m-%d"

[automation.lineage_guardian.integrity]
check_circular_dependencies = true
check_orphaned_entities = true
check_missing_references = true
check_duplicate_ids = true
health_score_threshold = 95.0

[automation.lineage_guardian.safety]
dry_run_default = true
scope_validation_required = true
allowed_paths = ["/config/domain/templates/"]
max_file_size_mb = 5
backup_retention_days = 30
