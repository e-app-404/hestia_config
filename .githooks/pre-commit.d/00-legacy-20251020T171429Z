#!/usr/bin/env bash
set -euo pipefail

# ADR-0015 symlink guard
if git ls-files -s | awk '$1==120000{print $4}' | grep -q .; then
  echo "E-ADR0015: Tracked symlinks detected. Remove before commit:" >&2
  git ls-files -s | awk '$1==120000{print " - "$4}' >&2
  exit 41
fi

# ADR-0018 storage guard
"$(dirname "$0")"/pre-commit-storage-guard

# ADR-0016 path expansion compliance
"$(dirname "$0")"/pre-commit-adr-0016-wrapper
