# Plex Variable Migration Template Sensors
# Provides backward compatibility during transition from HACS Variable to native HA helpers

template:
  - sensor:
      - name: "Plex TV Index (Legacy Compatibility)"
        unique_id: "plex_tv_index_compat"
        state: "{{ states('input_number.plex_tv_episode_count') | int(0) }}"
        attributes:
          shows: "{{ state_attr('input_text.plex_tv_index', 'value') | from_json | default({}) | selectattr('shows') | first | default({}) }}"
          seasons: "{{ state_attr('input_text.plex_tv_index', 'value') | from_json | default({}) | selectattr('seasons') | first | default({}) }}"
          episodes: "{{ state_attr('input_text.plex_tv_index', 'value') | from_json | default({}) | selectattr('episodes') | first | default({}) }}"
          updated: "{{ state_attr('input_text.plex_tv_index', 'value') | from_json | default({}) | selectattr('updated') | first | default('') }}"
        unit_of_measurement: "episodes"
        icon: mdi:television-box
        
      - name: "Plex Movie Index (Legacy Compatibility)"
        unique_id: "plex_movie_index_compat"
        state: "{{ states('input_number.plex_movie_count') | int(0) }}"
        attributes:
          movies: "{{ state_attr('input_text.plex_movie_index', 'value') | from_json | default({}) | selectattr('movies') | first | default({}) }}"
          year_released: "{{ state_attr('input_text.plex_movie_index', 'value') | from_json | default({}) | selectattr('year_released') | first | default({}) }}"
          updated: "{{ state_attr('input_text.plex_movie_index', 'value') | from_json | default({}) | selectattr('updated') | first | default('') }}"
        unit_of_measurement: "movies"
        icon: mdi:movie