# Composite per-room sensors that import logic from the Jinja library.
# State: ok | due | needs_cleaning | never
template:
  # Living Room
  - trigger:
      - platform: state
        entity_id: var.vacuum_living_room
      - platform: time_pattern
        minutes: "/30"
    sensor:
      - name: "Living Room Cleaning"
        unique_id: room_living_room_cleaning_v1
        icon: >
          {% from 'custom_template/template.library.jinja' import room_icon %}
          {{ room_icon('var.vacuum_living_room') }}
        state: >
          {% from 'custom_template/template.library.jinja' import room_state %}
          {{ room_state('var.vacuum_living_room', 24) }}
        attributes:
          room: "living_room"
          display_name: "Living Room"
          segment_id: >
            {% from 'custom_template/template.library.jinja' import get_segment_id %}
            {{ get_segment_id('var.vacuum_living_room') }}
          needs_cleaning: >
            {% from 'custom_template/template.library.jinja' import get_needs_cleaning %}
            {{ get_needs_cleaning('var.vacuum_living_room') }}
          last_cleaned: >
            {% from 'custom_template/template.library.jinja' import get_last_cleaned %}
            {{ get_last_cleaned('var.vacuum_living_room') }}
          cleaning_frequency_hours: >
            {% from 'custom_template/template.library.jinja' import get_freq %}
            {{ get_freq('var.vacuum_living_room', 24) }}
          hours_since_last_cleaned: >
            {% from 'custom_template/template.library.jinja' import hours_since %}
            {{ hours_since('var.vacuum_living_room') }}
          days_since_last_cleaned: >
            {% from 'custom_template/template.library.jinja' import days_since %}
            {{ days_since('var.vacuum_living_room') }}
          next_due_at: >
            {% from 'custom_template/template.library.jinja' import next_due %}
            {{ next_due('var.vacuum_living_room', 24) }}

  # Kitchen
  - trigger:
      - platform: state
        entity_id: var.vacuum_kitchen
      - platform: time_pattern
        minutes: "/30"
    sensor:
      - name: "Kitchen Cleaning"
        unique_id: room_kitchen_cleaning_v1
        icon: >
          {% from 'custom_template/template.library.jinja' import room_icon %}
          {{ room_icon('var.vacuum_kitchen') }}
        state: >
          {% from 'custom_template/template.library.jinja' import room_state %}
          {{ room_state('var.vacuum_kitchen', 24) }}
        attributes:
          room: "kitchen"
          display_name: "Kitchen"
          segment_id: >
            {% from 'custom_template/template.library.jinja' import get_segment_id %}
            {{ get_segment_id('var.vacuum_kitchen') }}
          needs_cleaning: >
            {% from 'custom_template/template.library.jinja' import get_needs_cleaning %}
            {{ get_needs_cleaning('var.vacuum_kitchen') }}
          last_cleaned: >
            {% from 'custom_template/template.library.jinja' import get_last_cleaned %}
            {{ get_last_cleaned('var.vacuum_kitchen') }}
          cleaning_frequency_hours: >
            {% from 'custom_template/template.library.jinja' import get_freq %}
            {{ get_freq('var.vacuum_kitchen', 24) }}
          hours_since_last_cleaned: >
            {% from 'custom_template/template.library.jinja' import hours_since %}
            {{ hours_since('var.vacuum_kitchen') }}
          days_since_last_cleaned: >
            {% from 'custom_template/template.library.jinja' import days_since %}
            {{ days_since('var.vacuum_kitchen') }}
          next_due_at: >
            {% from 'custom_template/template.library.jinja' import next_due %}
            {{ next_due('var.vacuum_kitchen', 24) }}

  # Powder Room
  - trigger:
      - platform: state
        entity_id: var.vacuum_powder_room
      - platform: time_pattern
        minutes: "/30"
    sensor:
      - name: "Powder Room Cleaning"
        unique_id: room_powder_room_cleaning_v1
        icon: >
          {% from 'custom_template/template.library.jinja' import room_icon %}
          {{ room_icon('var.vacuum_powder_room') }}
        state: >
          {% from 'custom_template/template.library.jinja' import room_state %}
          {{ room_state('var.vacuum_powder_room', 24) }}
        attributes:
          room: "powder_room"
          display_name: "Powder Room"
          segment_id: >
            {% from 'custom_template/template.library.jinja' import get_segment_id %}
            {{ get_segment_id('var.vacuum_powder_room') }}
          needs_cleaning: >
            {% from 'custom_template/template.library.jinja' import get_needs_cleaning %}
            {{ get_needs_cleaning('var.vacuum_powder_room') }}
          last_cleaned: >
            {% from 'custom_template/template.library.jinja' import get_last_cleaned %}
            {{ get_last_cleaned('var.vacuum_powder_room') }}
          cleaning_frequency_hours: >
            {% from 'custom_template/template.library.jinja' import get_freq %}
            {{ get_freq('var.vacuum_powder_room', 24) }}
          hours_since_last_cleaned: >
            {% from 'custom_template/template.library.jinja' import hours_since %}
            {{ hours_since('var.vacuum_powder_room') }}
          days_since_last_cleaned: >
            {% from 'custom_template/template.library.jinja' import days_since %}
            {{ days_since('var.vacuum_powder_room') }}
          next_due_at: >
            {% from 'custom_template/template.library.jinja' import next_due %}
            {{ next_due('var.vacuum_powder_room', 24) }}

  # Downstairs Hallway
  - trigger:
      - platform: state
        entity_id: var.vacuum_downstairs_hallway
      - platform: time_pattern
        minutes: "/30"
    sensor:
      - name: "Downstairs Hallway Cleaning"
        unique_id: room_downstairs_hallway_cleaning_v1
        icon: >
          {% from 'custom_template/template.library.jinja' import room_icon %}
          {{ room_icon('var.vacuum_downstairs_hallway') }}
        state: >
          {% from 'custom_template/template.library.jinja' import room_state %}
          {{ room_state('var.vacuum_downstairs_hallway', 24) }}
        attributes:
          room: "downstairs_hallway"
          display_name: "Downstairs Hallway"
          segment_id: >
            {% from 'custom_template/template.library.jinja' import get_segment_id %}
            {{ get_segment_id('var.vacuum_downstairs_hallway') }}
          needs_cleaning: >
            {% from 'custom_template/template.library.jinja' import get_needs_cleaning %}
            {{ get_needs_cleaning('var.vacuum_downstairs_hallway') }}
          last_cleaned: >
            {% from 'custom_template/template.library.jinja' import get_last_cleaned %}
            {{ get_last_cleaned('var.vacuum_downstairs_hallway') }}
          cleaning_frequency_hours: >
            {% from 'custom_template/template.library.jinja' import get_freq %}
            {{ get_freq('var.vacuum_downstairs_hallway', 24) }}
          hours_since_last_cleaned: >
            {% from 'custom_template/template.library.jinja' import hours_since %}
            {{ hours_since('var.vacuum_downstairs_hallway') }}
          days_since_last_cleaned: >
            {% from 'custom_template/template.library.jinja' import days_since %}
            {{ days_since('var.vacuum_downstairs_hallway') }}
          next_due_at: >
            {% from 'custom_template/template.library.jinja' import next_due %}
            {{ next_due('var.vacuum_downstairs_hallway', 24) }}

  # Laundry Room
  - trigger:
      - platform: state
        entity_id: var.vacuum_laundry_room
      - platform: time_pattern
        minutes: "/30"
    sensor:
      - name: "Laundry Room Cleaning"
        unique_id: room_laundry_room_cleaning_v1
        icon: >
          {% from 'custom_template/template.library.jinja' import room_icon %}
          {{ room_icon('var.vacuum_laundry_room') }}
        state: >
          {% from 'custom_template/template.library.jinja' import room_state %}
          {{ room_state('var.vacuum_laundry_room', 24) }}
        attributes:
          room: "laundry_room"
          display_name: "Laundry Room"
          segment_id: >
            {% from 'custom_template/template.library.jinja' import get_segment_id %}
            {{ get_segment_id('var.vacuum_laundry_room') }}
          needs_cleaning: >
            {% from 'custom_template/template.library.jinja' import get_needs_cleaning %}
            {{ get_needs_cleaning('var.vacuum_laundry_room') }}
          last_cleaned: >
            {% from 'custom_template/template.library.jinja' import get_last_cleaned %}
            {{ get_last_cleaned('var.vacuum_laundry_room') }}
          cleaning_frequency_hours: >
            {% from 'custom_template/template.library.jinja' import get_freq %}
            {{ get_freq('var.vacuum_laundry_room', 24) }}
          hours_since_last_cleaned: >
            {% from 'custom_template/template.library.jinja' import hours_since %}
            {{ hours_since('var.vacuum_laundry_room') }}
          days_since_last_cleaned: >
            {% from 'custom_template/template.library.jinja' import days_since %}
            {{ days_since('var.vacuum_laundry_room') }}
          next_due_at: >
            {% from 'custom_template/template.library.jinja' import next_due %}
            {{ next_due('var.vacuum_laundry_room', 24) }}
