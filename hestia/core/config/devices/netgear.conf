---
extracted_config:
  device: netgear_gs724t_v3
  role: managed_switch
  mgmt_ip: 192.168.0.254
  mac: 20:E5:2A:68:55:78
  subnet_mask: 255.255.255.0
  default_gateway: 192.168.0.1
  dns_servers:
    - 192.168.0.1     # Router (TP-Link AX53)
    - 8.8.8.8         # Google
    - 1.1.1.1         # Cloudflare
  ntp_servers:
    - 192.168.0.1     # Router forwards
    - 129.6.15.28     # NIST
    - 216.239.35.4    # Google Public NTP
  snmp:
    version: 2c
    community_strings:
      - public (RO)
    management_station: 192.168.0.129   # HA host
  vlan_config: default_only   # no VLANs defined yet
  lacp: disabled              # no link aggregation yet
  ui_access:
    web_ui: http://192.168.0.254
    credentials: 
      user: admin
      pass: (changed from default)
  save_config_required: true

transient_state:
  switch_status: online
  last_seen: "now"
  dhcp_status: disabled (moved to static IP)
  dns_resolution: expected_ok
  ntp_sync: pending (after server entries saved)
  snmp_poll: not yet tested

relationships:
  - source: netgear_gs724t_v3
    target: tp_link_ax53_router
    relation: default_gateway + dns_forwarder
  - source: netgear_gs724t_v3
    target: homeassistant
    relation: snmp_management_station
  - source: tp_link_ax53_router
    target: zyxel_nr5103e_modem
    relation: wan_passthrough
  - source: homeassistant
    target: netgear_gs724t_v3
    relation: planned_snmp_sensor_config

suggested_commands:
  # Verify SNMP from HA host
  - snmpwalk -v2c -c public 192.168.0.254 1.3.6.1.2.1.1.1.0

  # Check ifIndex mapping (for HA sensors)
  - snmpwalk -v2c -c public 192.168.0.254 1.3.6.1.2.1.31.1.1.1.1

  # Confirm NTP sync
  - ntpq -p 192.168.0.254

  # Backup switch config
  - curl -u admin:<password> http://192.168.0.254/backup.cfg -o gs724t_backup.cfg

notes:
  - Switch was initially discovered at 192.168.0.49 via DHCP.
  - Static IP assigned at 192.168.0.254 to avoid conflicts (outside DHCP range 192.168.0.2–.253).
  - SNTP config entered manually: Router as primary, fallback to NIST & Google.
  - DNS set to router → ensures consistency with Tailscale MagicDNS (100.100.100.100) and Cloudflare.
  - SNMP community "public" enabled for HA/Glances polling (RO only).
  - VLANs, LACP, and QoS not yet configured — optional next steps.
  - Reminder: Netgear web UI requires “Save Configuration” or changes will revert after reboot.


# Home Assistant entities

group:
  netgear_gs724t:
    name: "Netgear GS724T"
    icon: mdi:ethernet
    entities:
      - binary_sensor.gs724t_port1_link
      - binary_sensor.gs724t_port2_link
      - sensor.gs724t_sys_name
      - sensor.gs724t_sys_uptime_seconds
      - sensor.gs724t_if_count
      - sensor.gs724t_ifname_1
      - sensor.gs724t_ifname_2
      - sensor.gs724t_port1_oper_status_raw
      - sensor.gs724t_port2_oper_status_raw
      - sensor.gs724t_port1_in_octets
      - sensor.gs724t_port1_out_octets
      - sensor.gs724t_port1_in_Bps
      - sensor.gs724t_port1_out_Bps
      - sensor.gs724t_port_1_in_bps
      - sensor.gs724t_port_1_out_bps
