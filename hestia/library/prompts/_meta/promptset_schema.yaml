$schema: "http://json-schema.org/draft-07/schema#"
title: HESTIA Promptset Specification
type: object
required:
  - promptset

properties:
  promptset:
    type: object
    required:
      - id
      - version
      - created
      - description
      - persona
      - purpose
      - legacy_compatibility
      - schema_version
      - artifacts
      - bindings
      - prompts
    properties:
      id:
        type: string
        description: Unique identifier for the promptset
      version:
        type: string
        pattern: "^\\d+\\.\\d+(\\.\\d+)?$"
        description: Semantic version (e.g. 1.0.0)
      created:
        type: string
        format: date
      description:
        type: string
      persona:
        type: string
      purpose:
        type: string
      legacy_compatibility:
        type: boolean
      schema_version:
        type: string
        enum: ["1.0"]
      retrieval_tags:
        type: array
        items:
          type: string
      operational_modes:
        type: array
        items:
          type: string
          enum:
            - governance_review_mode
            - diagnostic_mode
            - enforcement_mode
            - technical_changelog_mode
            - legacy_mode
            - custom_mode
      artifacts:
        type: object
        properties:
          required:
            type: array
            items:
              type: object
              required: [path]
              properties:
                path:
                  type: string
          optional:
            type: array
            items:
              type: object
              required: [path]
              properties:
                path:
                  type: string
      bindings:
        type: object
        required: [protocols, persona]
        properties:
          protocols:
            type: array
            items:
              type: string
          persona:
            type: string
      prompts:
        type: array
        items:
          type: object
          required:
            - id
            - persona
            - label
            - mode
            - prompt
          properties:
            id:
              type: string
            persona:
              type: string
            label:
              type: string
            mode:
              type: string
              enum:
                - governance_review_mode
                - diagnostic_mode
                - enforcement_mode
                - legacy_mode
                - technical_changelog_mode
                - custom_mode
            protocols:
              type: array
              items:
                type: string
            bindings:
              type: array
              items:
                type: string
            prompt:
              type: string
            phases:
              type: array
              items:
                type: object
                required: [name, persona, instructions]
                properties:
                  name:
                    type: string
                  persona:
                    type: string
                  instructions:
                    type: string
                  outputs:
                    type: array
                    items:
                      type: object
                      required: [name, required, content]
                      properties:
                        name:
                          type: string
                        required:
                          type: boolean
                        content:
                          type: string

      migration:
        type: object
        properties:
          strategy:
            type: string

      extensibility:
        type: array
        items:
          type: string

      documentation:
        type: array
        items:
          type: string
