# Guardrails for SQL sensor usage and documentation
# These rules detect embedded credentials, literal passwords, and suspicious tokens in SQL sensor configs and docs.
rules:
  - id: sql-001
    title: "No literal DB passwords"
    description: "Database passwords must not appear as literal values in YAML or Markdown code blocks. Use `!secret` or template variables instead."
    severity: high
    pattern: |
      (?i)^\s*password:\s*(?!(\!secret|\{|\{\{)).+
    files: ["**/*.md","**/*.yaml","**/*.yml"]

  - id: sql-002
    title: "No credentials in DB URLs"
    description: "Avoid embedding 'user:password@' in DB connection URLs. Use `!secret` or separate credential mapping."
    severity: high
    pattern: |
      (?i)\b\w+://[^\s"']+:[^\s"'@]+@
    files: ["**/*.md","**/*.yaml","**/*.yml"]

  - id: sql-003
    title: "Avoid long tokens or plaintext API keys in examples"
    description: "Long-looking tokens should not be present in tracked files. Use placeholders or !secret."
    severity: medium
    pattern: |
      (?i)\b[a-z0-9A-Z_-]{20,}\b
    files: ["**/*.md","**/*.yaml","**/*.yml"]

version: 1
maintainer: hestia/ops
last_updated: 2025-09-24