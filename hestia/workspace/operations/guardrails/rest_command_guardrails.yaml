---
# Guardrails for rest_command usage and documentation
# This file documents the rules enforced by the check script and CI workflow.
rules:
  - id: rc-001
    title: "No literal passwords in config or docs"
    description: "Passwords must not appear as literal values in YAML or Markdown code blocks. Use `!secret` or templates instead."
    severity: high
    pattern: '(?i)^\s*password:\s*(?!(\!secret|\{|\{\{)).+'
    files: ["**/*.md","**/*.yaml","**/*.yml"]

  - id: rc-002
    title: "Authorization headers must use !secret, a template, or both"
    description: "Authorization header values should reference `!secret` or be templated; literal tokens or 'Bearer <token>' in docs/config are disallowed."
    severity: high
    pattern: '(?i)authorization:\s*(?!!secret|\{\{).+'
    files: ["**/*.md","**/*.yaml","**/*.yml"]

  - id: rc-003
    title: "Avoid embedding long tokens in examples"
    description: "Long-looking tokens (base64-like or long hyphenated strings) should not be present in tracked files. Use placeholders or !secret."
    severity: medium
    pattern: '(?i)\b[a-z0-9A-Z_-]{20,}\b'
    files: ["**/*.md","**/*.yaml","**/*.yml"]

version: 1
maintainer: hestia/ops
last_updated: 2025-09-24
