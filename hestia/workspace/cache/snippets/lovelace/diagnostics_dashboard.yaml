title: Sensor Diagnostics
path: diagnostics
icon: mdi:tools
max_columns: 4
header:
  card:
    type: markdown
    text_only: true
    content: |
      # Sensor Diagnostics
      This dashboard visualizes the data flow and health of all motion, occupancy, and presence sensors. Use it to quickly spot issues, anomalies, and lineage relationships.
sections:
  - type: grid
    cards:
      - type: heading
        heading: Sensor Entity Health
        icon: mdi:heart-pulse
        heading_style: subtitle
      - type: custom:auto-entities
        card:
          type: entities
          title: "All Motion/Occupancy/Presence Sensors"
        filter:
          include:
            - domain: binary_sensor
              attributes:
                device_class: motion
            - domain: binary_sensor
              attributes:
                device_class: occupancy
            - domain: binary_sensor
              attributes:
                device_class: presence
          exclude:
            - state: unavailable
            - state: unknown
        show_empty: false
        sort:
          method: name
      - type: custom:background-graph-entities
        title: "Sensor History (Last 24h)"
        entities:
          - binary_sensor.bedroom_motion_beta
          - binary_sensor.bedroom_occupancy_beta
          - binary_sensor.bedroom_presence_beta
          - binary_sensor.ensuite_motion_beta
          - binary_sensor.ensuite_occupancy_beta
          - binary_sensor.ensuite_presence_beta
          - binary_sensor.desk_motion_proxy
          - binary_sensor.desk_occupancy_beta
          - binary_sensor.desk_presence_beta
          - binary_sensor.kitchen_motion_beta
          - binary_sensor.kitchen_occupancy_beta
          - binary_sensor.kitchen_presence_beta
          - binary_sensor.living_room_motion_beta
          - binary_sensor.living_room_occupancy_beta
          - binary_sensor.living_room_presence_beta
          - binary_sensor.hallway_downstairs_motion_beta
          - binary_sensor.hallway_downstairs_occupancy_beta
          - binary_sensor.hallway_downstairs_presence_beta
          - binary_sensor.hallway_upstairs_motion_beta
          - binary_sensor.hallway_upstairs_occupancy_beta
          - binary_sensor.hallway_upstairs_presence_beta
        hours_to_show: 24
        points_per_hour: 6
      - type: custom:sankey-chart
        title: "Sensor Data Flow"
        nodes:
          - id: motion
            name: Motion
          - id: occupancy
            name: Occupancy
          - id: presence
            name: Presence
        links:
          - source: motion
            target: occupancy
            value: 1
          - source: occupancy
            target: presence
            value: 1
        entities:
          - binary_sensor.bedroom_motion_beta
          - binary_sensor.bedroom_occupancy_beta
          - binary_sensor.bedroom_presence_beta
          - binary_sensor.ensuite_motion_beta
          - binary_sensor.ensuite_occupancy_beta
          - binary_sensor.ensuite_presence_beta
          - binary_sensor.desk_motion_proxy
          - binary_sensor.desk_occupancy_beta
          - binary_sensor.desk_presence_beta
          - binary_sensor.kitchen_motion_beta
          - binary_sensor.kitchen_occupancy_beta
          - binary_sensor.kitchen_presence_beta
          - binary_sensor.living_room_motion_beta
          - binary_sensor.living_room_occupancy_beta
          - binary_sensor.living_room_presence_beta
          - binary_sensor.hallway_downstairs_motion_beta
          - binary_sensor.hallway_downstairs_occupancy_beta
          - binary_sensor.hallway_downstairs_presence_beta
          - binary_sensor.hallway_upstairs_motion_beta
          - binary_sensor.hallway_upstairs_occupancy_beta
          - binary_sensor.hallway_upstairs_presence_beta
      - type: custom:auto-entities
        card:
          type: entities
          title: "Sensor Anomalies"
        filter:
          include:
            - entity_id: sensor.*_anomalies*
        show_empty: true
        sort:
          method: last_changed
