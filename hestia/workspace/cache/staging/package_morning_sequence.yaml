# ══════════════════════════════════════════════════════════════════
# ⟫⟫ PACKAGE: MORNING SEQUENCE ◀
# ⟫⟫ Tier: η  •  Domain: daily routines  •  Created: 2025-08-05
# TODO: Finalize the morning sequence script with all components.
# ══════════════════════════════════════════════════════════════════

input_boolean:
  morning_sequence_enable_lights:
    name: "Enable Morning Lights"
    icon: mdi:lightbulb-on

  morning_sequence_enable_pa:
    name: "Enable Morning PA"
    icon: mdi:speaker-message

  morning_sequence_enable_radio:
    name: "Enable Morning Radio"
    icon: mdi:radio

script:
  initiate_morning_sequence:
    alias: "Initiate Morning Sequence"
    mode: queued
    sequence:
      # ░░ LIGHTS ░░
      - choose:
          - conditions:
              - condition: state
                entity_id: input_boolean.morning_sequence_enable_lights
                state: "on"
            sequence:
              - service: light.turn_on
                target:
                  entity_id:
                    - group.bedroom_main_lights
                    - group.ensuite_lights
                data:
                  brightness_pct: 50
                  color_temp: 300

      # ░░ PA ANNOUNCEMENT ░░
      - choose:
          - conditions:
              - condition: state
                entity_id: input_boolean.morning_sequence_enable_pa
                state: "on"
            sequence:
              - service: media_player.volume_set
                target:
                  entity_id: media_player.bedroom_sonos_surround
                data:
                  volume_level: 0.25

              - service: tts.cloud_say
                data:
                  entity_id: media_player.bedroom_sonos_surround
                  message: >
                    Good morning, Evert! It's {{ now().strftime('%A, %B %d, %Y') }}.
                    The time is {{ now().strftime('%H:%M') }}.

                    Here's your morning update:
                    - The weather today: {mostly sunny}, with a high of {22 degrees Celsius}.
                    - Your sleep score: {sleep_score_placeholder}.
                    - Your resting heart rate: {resting_hr_placeholder} bpm.

                    Wishing you a productive and positive day ahead in London!

              # TODO: Biometrics – Withings integration (to be added)
              # TODO: Real weather integration (e.g. from sensor or weather entity)

      # ░░ RADIO ░░
      - choose:
          - conditions:
              - condition: state
                entity_id: input_boolean.morning_sequence_enable_radio
                state: "on"
            sequence:
              - service: media_player.volume_set
                data:
                  volume_level: 0.30
                target:
                  entity_id: media_player.bedroom_sonos_surround

              - service: media_player.volume_set
                data:
                  volume_level: 0.45
                target:
                  entity_id: media_player.ensuite_sonos_roam

              - service: media_player.volume_set
                data:
                  volume_level: 0.20
                target:
                  entity_id: media_player.kitchen_sonos_speaker

              - service: media_player.play_media
                target:
                  entity_id:
                    - media_player.bedroom_sonos_surround
                    - media_player.ensuite_sonos_roam
                    - media_player.kitchen_sonos_speaker
                data:
                  media_content_type: music
                  media_content_id: "http://vrt.streamabc.net/vrt-studiobrussel-mp3-128-4409118"
