# Governance Index (autogenerated)

_Refreshed (UTC): 2025-10-15T01:44:41_

**Hot rules Copilot must honor:**

- ADR-0024: Single canonical config mount → `/config` only; no dual SMB mounts.

- ADR-0022: Mount management via LaunchAgent; preflight before writes.

- Path contracts: prefer container paths over host aliases; avoid `/Volumes/...` in tooling.


---

## ADR catalogue

- **1. Context** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0026-workspace-environment-ops.md`  
  Decision: (see file)

- **ADR-0001: Templated TTS YAML Snippet** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0001-tts-yaml.md`  
  Decision: (see file)

- **ADR-0002: Home Assistant Jinja Pattern Normalization** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0002-jinja-patterns.md`  
  Decision: (see file)

- **ADR-0003: Canonical Tier Definitions for Home Assistant Entity Architecture** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0003-tier-definitions.md`  
  Decision: (see file)

- **ADR-0004: Canonical Area Hierarchy & Spatial Relationship Contract** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0004-area-hierarchy.md`  
  Decision: (see file)

- **ADR-0005: Entity Registry, Sensor Matrix, Logic Path Index, and Signal Emitters Contract** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0005-entity-sensor-logic-signal.md`  
  Decision: (see file)

- **ADR-0006: Decay and Propagation Logic Contract** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0006-decay-propagation.md`  
  Decision: (see file)

- **ADR-0007: Meta/Governance Patterns and Schema Definitions Contract** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0007-meta-governance-schema.md`  
  Decision: (see file)

- **ADR-0008: Syntax-Aware Normalization & Determinism Rules for Config Artifacts** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0008-normalization-and-determinism-rules.md`  
  Decision: Adopt a **syntax-aware** normalization profile and a **deterministic packaging** process that together guarantee: 1) Byte-stable outputs for identical inputs, 2) Minimal diffs (whitespace and ordering normalized), 3) A single canonical SHA256 for each release.

- **ADR-0009: ADR Governance, Redaction, and Formatting Policy** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0009-adr-governance-formatting.md`  
  Decision: (see file)

- **ADR-0011: Switch Modeling & Validation (Netgear GS724T v3 and Similar)** — _Approved_  
  `/config/hestia/library/docs/ADR/ADR-0011-switch-modeling-and-validation.md`  
  Decision: Adopt a canonical **Switch Model** with deterministic artifacts and strict validation. Treat the Netgear backup as the source of truth, transformed into normalized outputs: 1) `switch.conf` — human-readable summary (sections: management, vlans, ports, lags, stp, acls). 2) `vlans.conf` — VLAN table: ```yaml vlans: - vlan_id: 1 name: default role: default subnet: null # optional notes: "" ``` 3) `ports.csv` — per-port mapping with columns: ```pgsql port,mode,pvid,tagged,untagged,lag,description 1,trunk,1,"[10,20]","[]",,Uplink to Router

- **ADR-0013 — Source→Core Config Merge via `extracted_config` (Meta-Capture Pipeline)** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0013-extracted-config-merge.md`  
  Decision: (see file)

- **ADR-0014: Recorder Policy, OOM Guard & Repo Guardrails (v2)** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0014-oom-and-recorder-policy.md`  
  Decision: Adopt a **single, canonical recorder configuration** with short retention and strict excludes, enforce **OOM sentinel**, and implement **repo-level guardrails** to make the policy machine-checkable.

- **ADR-0015: Symlink Policy for Hestia Config Workspace** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0015-symlink-policy-workspace.md`  
  Decision: (see file)

- **ADR-0020 — Home Assistant Configuration Error Canonicalization** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0020-ha-config-error-canonicalization.md`  
  Decision: Create a systematic approach to configuration error management with three components:

- **ADR-0021 — Motion, Occupancy, and Presence Signal Architecture (beta abstractions)** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0021-motion-occupancy-presence-signals.md`  
  Decision: (see file)

- **ADR-0022: Home Assistant Mount Keychain Credentials and Telemetry System** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0022-hass-mount-keychain-creds-telemetry.md`  
  Decision: (see file)

- **ADR-0023: Operator Priority Resolution for Workspace Merge Conflicts** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0023-operator-priority-merge-resolution.md`  
  Decision: (see file)

- **ADR-0027: File Writing Governance and Path Enforcement System** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0027-file-writing-governance.md`  
  Decision: Implement a comprehensive three-layer file writing governance system:

- **on NAS host, in bare repo; run as repo owner (e.g., gituser)** — _Accepted_  
  `/config/hestia/library/docs/ADR/ADR-0019-remote-topology-mirror-policy.md`  
  Decision: 1) **Source of truth** = `github/main`. 2) **NAS mirror** is **pull-only** (no dev pushes). It is updated by **fetching from GitHub**, not by direct developer force-pushes. 3) All risky ref moves (force updates, history surgery) **must**: - create **backup branch + tag** first, - be recorded with a **receipt** in `hestia/reports/<YYYYMMDD>/...`, - follow ADR-0017 commands (one-at-a-time). 4) CI gates (ADR-0018) are required on PRs into `main`: - `hygiene-gate / gate` - `ADR-0018 Extra Guards / guards` - `ADR Frontmatter Verify / verify`

- **1) Purpose** — _Proposed (Ready to adopt)_  
  `/config/hestia/library/docs/ADR/ADR-0018-workspace-lifecycle-policy.md`  
  Decision: (see file)

- **ADR-000x: Example Policy** — _Draft_  
  `/config/hestia/library/docs/ADR/ADR-000x-template.md`  
  Decision: (see file)

- **ADR-0010: Workspace Shape (amended by ADR-0016)** — _Superseded_  
  `/config/hestia/library/docs/ADR/deprecated/ADR-0010-workspace-shape-and-autofs.md`  
  Decision: 1) **Neutral macOS path (operator convenience only):** On macOS, the Home Assistant `config` share is mounted at **`/n/ha`** via **autofs** (direct map in `/etc/auto_master` referencing `/etc/auto_smb`). 2) **Portability rule (scripts & docs):** - Repo **scripts/Makefiles** MUST NOT hardcode `/n/ha`. Use a parameterized root: `HA_ROOT` defaulting to `/config`. - Example: `ROOT="${HA_ROOT:-/config}"`. - Cross-platform docs use repo-relative or `/config` paths. `/n/ha` is permitted **only** in macOS-specific operator guides. - Canonical template entrypoint remains: `/config/custom

- **ADR-0012: Four-Pillar Workspace Architecture** — _Superseded_  
  `/config/hestia/library/docs/ADR/deprecated/ADR-0012-workspace-folder-taxonomy.md`  
  Decision: (see file)

- **ADR-0016 — Canonical HA edit root & non‑interactive SMB mount** — _Superseded_  
  `/config/hestia/library/docs/ADR/deprecated/ADR-0016-canonical-ha-smb-mount.md`  
  Decision: (see file)

- **ADR-0017 — Fallback local logging path for Home Assistant tooling (non-repo, cross-platform)** — _Pending Validation_  
  `/config/hestia/library/docs/ADR/ADR-0017-fallback-local-logging.md`  
  Decision: When the primary Home Assistant config mount (the operator's `root config` mount) is unavailable, tooling and scripts MUST write fallback logs to the operator's local directory: `/Users/evertappels/Projects/HomeAssistant/logs` This location is to be used only as a last-resort fallback when the canonical logging or config locations are unreachable.

- **ADR-0028: AppDaemon & Room-DB Canonicalization (Endpoints, Entities, SQL Migration)** — _Proposed_  
  `/config/hestia/library/docs/ADR/ADR-0028-appdaemon-room-db-sql-migration.md`  
  Decision: (see file)

- **Architecture POA for Hestia Metadata Schema** — _Unspecified_  
  `/config/hestia/library/docs/ADR/architecture_POA.md`  
  Decision: (see file)

- **Hestia Content Strategy: Final Structure & Purpose** — _Unspecified_  
  `/config/hestia/library/docs/ADR/hestia_structure.md`  
  Decision: (see file)

- **name<TAB>relative-path-under-/System/Volumes/Data** — _Implemented_  
  `/config/hestia/library/docs/ADR/ADR-0024-canonical-config-path.md`  
  Decision: * Keep **`homeassistant.local` → `/config`** as the **only** writable config mount. * **Block** automatic mounts of the Tailscale host to `/Volumes/HA/{config,share,addons}` in normal operation. * Allow **manual, temporary** mounts of `share`/`addons` for ad-hoc use; tools/automations **must not** reference them. * Enforce a `/config` **preflight** before any write. * Editors/agents/workflows **must reference `/config` only** (workspace updated). * Keychain hygiene: keep creds for `homeassistant.local`; remove `homeassistant.reverse-beta.ts.net` to prevent auto-remounts.
